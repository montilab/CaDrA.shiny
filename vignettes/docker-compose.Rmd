---
title: "Launch CaDrA's Shiny Dashboard with Compose"
output: BiocStyle::html_document
vignette: >
  %\VignetteIndexEntry{Launch CaDrA's Shiny Dashboard with Compose}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include=FALSE, messages=FALSE, warnings=FALSE}
knitr::opts_chunk$set(message=FALSE, collapse = TRUE, comment="")
```

## Software requirements

- Git version >= 2.21
- Docker version >= 20.10
- Docker-compose version >= 2.23

Don't have Git installed, see [Git Guides](https://github.com/git-guides/install-git)

Don't have Docker installed, see [Docker Engine](https://docs.docker.com/engine/install/)

Don't have Compose installed, see [Compose Plugin](https://docs.docker.com/compose/install/)

### (1) Clone `CaDrA` and `CaDrA.shiny` repositories

```bash
git clone https://github.com/montilab/CaDrA.git
``` 

```bash
git clone https://github.com/montilab/CaDrA.shiny.git
``` 

### (2) Navigate to `CaDrA.shiny` folder where `docker-compose.yml` is stored and edit that yaml file to configure variables needed to build its Docker image and mount appropriate data inputs and code base to run its container

Here is a list of configurations:

- Specify a version of R to use as a base image to launch `CaDrA.shiny` dashboard. Default `R_VERSION=4.3.0`
- Specify a release branch of `CaDrA` which one can pull and build its package directly from its Github repo. Default `CADRA_BRANCH=devel`
- Mount external data files (e.g. feature sets, gene expression sets, input scores, etc.) to populate `CaDrA.shiny` dashboard with. One can place external data files in a desired directory (e.g. `/path/to/extdata`) and change __/path/to/extdata__ to your defined **extdata** directory in `docker-compose.yml`.

```bash
x-cadra-shiny-extdata:
  &cadra-shiny-extdata
  type: bind
  source: /path/to/extdata
  target: /CaDrA.shiny/inst/extdata
```

- Mount code base of **CaDrA**, change __/path/to/CaDrA__ to your **CaDrA** directory.

```bash
x-cadra-code:
  &cadra-code
  type: bind
  source: /path/to/CaDrA
  target: /CaDrA
```

- Mount code base of **CaDrA.shiny**, change __/path/to/CaDrA.shiny__ to your **CaDrA.shiny** directory

```bash
x-cadra-shiny-code:
  &cadra-shiny-code
  type: bind
  source: /path/to/CaDrA.shiny
  target: /CaDrA-shiny
```

### (3) Start `cadra.shiny` service in `docker-compose.yml` to trigger the build, run its container, and finally launch `CaDrA.shiny` dashboard
```bash
docker-compose up -d 
```

**`-d`**: run the container in detached mode

For more information about the docker-compose syntax, see [docker-compose up reference](https://docs.docker.com/engine/reference/commandline/compose_up/)

### (4) Check if the image is built successfully

```bash
docker images

REPOSITORY        TAG        IMAGE ID        CREATED        SIZE
cadra.shiny       latest     2c22887402d3    2 hours ago    2.56GB
```

### (5) Check if the container runs successfully

```bash
docker ps


CONTAINER ID   IMAGE               COMMAND                    CREATED        STATUS        PORTS                    NAMES
b37b6b19c4e8   cadra.shiny:latest  "/bin/bash -c /user/..."   5 hours ago    Up 5 hours    0.0.0.0:4567->3838/tcp   cadra.shiny
```

### (6) Access `CaDrA.shiny` dashboard on your localhost

Using your preferred web browser, type in http://localhost:4567 and see if `CaDrA.shiny` dashboard is indeed hosted there.

<img src="figures/cadra-shiny-landing-page.png"/>

<br><br>

Any questions or issues? Please report them on our [github issues](https://github.com/montilab/CaDrA.shiny/issues).



